30 Parametrischer Polymorphismus und das Kovarianzproblem

In gewisser Weise hat man es beim rekursiv beschränkten parametrischen Polymorphismus wie oben vorgestellt mit einem Fall von kovarianter Redefinition zu tun: Der Parametertyp der Methode = ändert sich mit dem Empfängertyp. Allerdings ergibt sich daraus, anders als bei der Verwendung von Self als Typvariable, kein Widerspruch zur Kontravarianzregel des Subtyping, denn Integer wird dadurch unmittelbar ja lediglich zu einem Subtyp von Equatable[Integer] und nicht etwa von Equatable[Object]. Tatsächlich sind Equatable[Integer] und Equatable[Object] ja zwei vollkommen verschiedene Typen (mit disjunkten Wertebereichen), und Equatable[T] ist gar kein Typ (so dass man auch keine Variable mit ihm deklarieren kann), sodass keinerlei Zuweisungskompatibilität und damit auch kein Problem mit Typkorrektheit besteht.


Frage: Was ist kovariante Redefinition?
Antwort: Kovariante Redefinition bezieht sich auf eine Situation, in der der Parametertyp einer Methode sich mit dem Empfängertyp ändert. Im Fall des rekursiv beschränkten parametrischen Polymorphismus wird der Parametertyp der Methode zu einem Subtyp des Empfängertyps, was keinen Widerspruch zur Kontravarianzregel des Subtyping darstellt.

Frage: Was ist der Unterschied zwischen kovarianter Redefinition und kontravarianter Redefinition?
Antwort: Kovariante Redefinition tritt auf, wenn der Parametertyp der Methode sich mit dem Empfängertyp ändert, während kontravariante Redefinition auftritt, wenn der Parametertyp der Methode sich in die entgegengesetzte Richtung zum Empfängertyp ändert. In diesem Fall ist es kein Widerspruch zur Kontravarianzregel des Subtyping, da Integer unmittelbar zu einem Subtyp von Equatable[Integer] wird und nicht von Equatable[Object]. Equatable[Integer] und Equatable[Object] sind zwei vollkommen verschiedene Typen mit disjunkten Wertebereichen, und Equatable[T] ist kein Typ, sodass keinerlei Zuweisungskompatibilität und damit auch kein Problem mit Typkorrektheit besteht.


Trotzdem stellt sich die Frage, ob sich das in Abschnitt 26.3 angesprochene allgemeine Problem der wünschenswerten kovarianten Redefinition von Eingabeparametern in Methoden mittels parametrischen Polymorphismus nicht irgendwie lösen lässt. Die Antwort ist unbefriedigend: nur zum Teil.


Frage: Was ist das Problem der wünschenswerten kovarianten Redefinition von Eingabeparametern in Methoden?
Antwort: Das Problem ist, dass wenn eine Unterklasse eine Methode der Oberklasse redefiniert, die Eingabeparameter der Unterklassenmethode nicht kovariant mit den Eingabeparametern der Oberklassenmethode sein dürfen, was aber wünschenswert wäre.

Frage: Was bedeutet kovariant?
Antwort: Kovariant bedeutet, dass die Typen der Eingabeparameter der Unterklassenmethode mit den Typen der Eingabeparameter der Oberklassenmethode kompatibel sein müssen, aber nicht unbedingt identisch sein müssen.

Frage: Was ist parametrischer Polymorphismus?
Antwort: Parametrischer Polymorphismus ist eine Technik, bei der eine Funktion oder Methode mit verschiedenen Typen von Eingabeparametern verwendet werden kann, ohne dass eine separate Funktion oder Methode für jeden Typ definiert werden muss.

Frage: Kann das Problem der wünschenswerten kovarianten Redefinition von Eingabeparametern in Methoden mit parametrischen Polymorphismus gelöst werden?
Antwort: Nur zum Teil, da parametrischer Polymorphismus zwar die Verwendung von verschiedenen Typen von Eingabeparametern ermöglicht, aber nicht die kovariante Redefinition von Eingabeparametern in Unterklassenmethoden.

Die Kovarianz ist in keiner Typdefinition festgehalten, sondern lediglich in der Deklaration von z. Es hindert einen insbesondere nichts daran, dieselbe oder eine andere Variable zu deklarieren. Man beachte, dass es hier keine Möglichkeit gibt, einen bestimmten Wert für einen Typparameter vorzuschreiben. Kovariante Redefinition bei gleichzeitiger Inklusionspolymorphie lässt sich auch mittels parametrischer Typen nicht hinbekommen.

Frage: Was ist Kovariante Redefinition bei gleichzeitiger Inklusionspolymorphie?
Antwort: Kovariante Redefinition bei gleichzeitiger Inklusionspolymorphie ist eine Technik in der objektorientierten Programmierung, bei der ein Subtyp eine Methode seines Obertyps mit einem spezifischeren Rückgabetyp neu definieren kann, während er gleichzeitig die Liskov-Substitutionsprinzip einhält. Diese Technik kann jedoch nicht mit parametrischen Typen erreicht werden.
