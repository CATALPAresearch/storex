47.2 Exception Handling

Wie Sie bereits in den Anweisungen in Kapitel 38 gesehen haben, bietet JAVA ein sogenanntes Exception Handling. Beim Exception Handling handelt es sich um eine Möglichkeit, bei der Spezifikation des Kontrollflusses eines Programms zunächst mögliche Ausnahmesituationen und deren Behandlung unberücksichtigt zu lassen und so zu tun, als würde immer alles gutgehen. Da dies normalerweise der Fall sein sollte, erlaubt es sowohl der Autorin als auch dem Leser eines Programms, sich auf die Hauptfunktion zu konzentrieren, mit dem Motto "Zu den Ausnahmen kommen wir später!"
Die möglichen Ausnahmesituationen eines Programms werden in JAVA in Klassen unterteilt, deren Instanzen jeweils eine konkrete Ausnahmesituation während des Programmablaufs repräsentieren. Wenn beispielsweise in einem Programm auf ein Element eines Arrays zugegriffen werden soll, dessen Index außerhalb der Grenzen des Arrays liegt, erzeugt die JVM, die über die Einhaltung der Array-Grenzen wacht, eine Instanz der Klasse ArrayIndexOutOfBoundsException und wirft diese. Das Werfen einer Exception (genauer gesagt, einer Instanz einer Exception-Klasse) bedeutet, dass der Programmablauf an der aktuellen Stelle unterbrochen und an der nächsten Stelle fortgesetzt wird, an der ein passender Exception Handler für den Typ der geworfenen Exception vorhanden ist. Dies erfordert, dass der Codeabschnitt, in dem die Exception auftreten kann, in einen Try-Catch-Block eingefasst wird.
Wenn der Typ der geworfenen Exception nicht in einer der Catch-Klauseln aufgeführt ist, wird die Exception als unbehandelt betrachtet, und die nächst umgebende Klammer wird nach einer passenden Behandlung durchsucht. Wenn keine geeignete Behandlung gefunden wird, führt dies zu einem Programmabbruch mit einer entsprechenden Fehlermeldung ("Exception in thread ...").
Ausnahmesituationen können jedoch auch vom Programm selbst erkannt und gemeldet werden, indem die bereits erwähnte Throw-Anweisung verwendet wird, um eine entsprechende Exception-Klasse zu instanziieren. Dies ermöglicht es, die Verantwortung für die Behandlung von Ausnahmen von der virtuellen Maschine auf das Programm selbst zu verlagern.
Try-Catch-Anweisungen in JAVA werden, wie fast alle Anweisungen, im Körper von Methoden platziert. Wenn eine Methode eine bestimmte Exception wirft, ohne sie selbst abzufangen (d. h., wenn die Throw-Anweisung nicht innerhalb eines Try-Catch-Blocks verwendet wird, der eine passende Catch-Klausel enthält), muss die Methode dies deklarieren. Dies geschieht durch Hinzufügen einer Throws-Klausel zur Methodendeklaration.
Eine Methode, die die obige Methode aufruft, muss den Aufruf entweder in einen Try-Catch-Block einschließen, der die erforderliche Catch-Klausel enthält, oder selbst deklarieren, dass sie die Exception behandelt oder weiterwirft.
Diese Praxis kann zwar zu erheblichem Schreibaufwand führen, stellt jedoch die einzige Möglichkeit dar, sicherzustellen, dass die Programmierer sich der möglichen Ausnahmesituationen bewusst sind, ohne die Kontrollflussspezifikation übermäßig zu belasten. Exceptions, die eine Deklaration im Methodenkopf erfordern oder innerhalb der Methode behandelt werden müssen, werden als Checked Exceptions bezeichnet.
Es gibt jedoch auch Exceptions, bei denen dies nicht erforderlich ist, die sogenannten Unchecked Exceptions. Im Gegensatz zu Checked Exceptions können Unchecked Exceptions in der Praxis überall auftreten. Ein prominentes Beispiel ist die "Out of Memory Exception", die auftritt, wenn eine Speicheranforderung des Programms von der JVM nicht erfüllt werden kann. Eine weitere häufige, aber programmatisch vermeidbare Exception ist die "Null Pointer Exception", die auftritt, wenn ein Ausdruck, auf dem auf ein Feld oder eine Methode zugegriffen wird, zu null ausgewertet wird. In dieselbe Kategorie fällt auch die "Array Index Out of Bounds Exception", die durch sorgfältiges Programmieren vermieden werden könnte, aber dennoch häufig vorkommt.
Es wäre äußerst mühsam, jede Anweisung, bei der eine solche Exception auftreten könnte, mit einem Try-Catch-Block abzusichern. Daher gibt es in JAVA Exceptions, bei denen dies nicht erforderlich ist, die sogenannten Unchecked Exceptions. Die Unterscheidung, ob eine Exception als Checked oder Unchecked gilt, liegt nicht in der Hand der Programmiererin, die sie wirft, sondern erfolgt anhand der Vererbungshierarchie der Exception-Klassen. Alle Exceptions, die von der Klasse RuntimeException abgeleitet sind, werden per Definition als Unchecked betrachtet. RuntimeException selbst ist eine Subklasse der Klasse Exception, die wiederum eine Subklasse von Throwable ist. Throwable ist die Superklasse aller Klassen, die in Throw-Anweisungen, Catch-Zweigen und Throws-Klauseln verwendet werden dürfen. Mit RuntimeException wird also ein Zweig der Exception-Klassenhierarchie eingeleitet, dessen Elemente alle als Unchecked gelten.
Neben Exception ist auch Error eine Subklasse von Throwable. Errors sollten jedoch nicht abgefangen werden und führen zu einem sofortigen Programmabbruch. Auslassungszeichen stehen für die Formulierung einer Invariante, wurde früher zur Emulation der mittlerweile vorhandenen Assert-Anweisung verwendet. Auch heute sollte man Errors eigentlich nur während der Testphase eines Programms einsetzen. Genauso wie Exceptions der Sorte RuntimeException sind Errors unchecked.

Frage: Was ist Exception Handling in JAVA?
Antwort: Exception Handling ist eine Möglichkeit in JAVA, mögliche Ausnahmesituationen und deren Behandlung bei der Spezifikation des Kontrollflusses eines Programms vorübergehend zu vernachlässigen und so zu tun, als würde immer alles gutgehen. Ausnahmesituationen werden in JAVA in Form von Exception-Klassen dargestellt.

Frage: Was passiert, wenn der Typ der geworfenen Exception nicht in einer Catch-Klausel aufgeführt ist?
Antwort: Wenn der Typ der geworfenen Exception nicht in einer Catch-Klausel aufgeführt ist, wird die Exception als unbehandelt betrachtet. Die nächst umgebende Klammer wird nach einer passenden Behandlung durchsucht. Wenn keine geeignete Behandlung gefunden wird, führt dies zu einem Programmabbruch mit einer entsprechenden Fehlermeldung ("Exception in thread ...").

Frage: Was sind Checked Exceptions in JAVA?
Antwort: Checked Exceptions sind Ausnahmesituationen, bei denen die Programmierer sich der möglichen Ausnahmesituationen bewusst sein müssen. Sie erfordern eine Deklaration im Methodenkopf oder müssen innerhalb der Methode behandelt werden. Diese Exceptions werden von Exception-Klassen abgeleitet, die nicht von RuntimeException abgeleitet sind.

Frage: Was sind Unchecked Exceptions in JAVA?
Antwort: Unchecked Exceptions sind Ausnahmesituationen, die in der Praxis überall auftreten können. Sie erfordern keine explizite Deklaration im Methodenkopf und können überall auftreten. Unchecked Exceptions werden von Exception-Klassen abgeleitet, die von RuntimeException abgeleitet sind.

Frage: Was ist der Unterschied zwischen Checked und Unchecked Exceptions in JAVA?
Antwort: Der Hauptunterschied besteht darin, dass Checked Exceptions eine explizite Deklaration im Methodenkopf oder eine Behandlung innerhalb der Methode erfordern, während Unchecked Exceptions dies nicht tun. Checked Exceptions werden von Exception-Klassen abgeleitet, die nicht von RuntimeException abgeleitet sind, während Unchecked Exceptions von Exception-Klassen abgeleitet werden, die von RuntimeException abgeleitet sind. Checked Exceptions sollen den Programmierer auf mögliche Ausnahmesituationen hinweisen, während Unchecked Exceptions oft schwer vorhersehbar sind und überall auftreten können.