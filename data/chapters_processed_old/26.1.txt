26.1 Der Begriff des Subtyps

Ein Subtyp ist als ein Typ definiert, dessen Werte oder Objekte überall auftauchen dürfen, wo ein Wert des Typs, von dem er ein Subtyp ist, verlangt wird. Subtyp steht dabei nicht für eine besondere Art von Typ, sondern vielmehr für eine Rolle in einer Beziehung zwischen zwei Typen, nämlich der Subtypenbeziehung. Die Gegenrolle heißt Supertyp.
Man beachte, dass diese Definition von Subtypen Zuweisungskompatibilität impliziert: Wenn die Objekte eines Subtypen überall auftauchen dürfen, wo Objekte seines Supertyps erwartet werden, dann dürfen sie auch Werte von jemandem zugreifen, der bei einer Zeichnung auf ihre Zeilen zugreifen will. Außerdem müsste bei der ersten Annahme des allgemeinsten Typs, von dem alle anderen abgeleitet sind (Object in STRONGTALK), immer alle Attribute deklariert werden, die einem jemals in den Sinn kämen, und das wäre nun wirklich unpraktisch. Die Problemquelle könnten Variablen sein, die mit dem Supertypen annotiert sind (auf Werte des Supertyps beschränkt). Ein Subtyp ist also per Definition mit seinem Supertyp zuweisungskompatibel. In dieser Definition steckt jedoch eine gewisse Zirkularität (Subtyp als Voraussetzung und Ergebnis der Zuweisungskompatibilität), die eine Einfachheit der Zusammenhänge vortäuscht, die es in Wirklichkeit nicht gibt. Die eigentliche Frage, was nämlich erfüllt sein muss, damit ein Objekt eines Typs tatsächlich dort erscheinen darf, wo ein Objekt eines anderen Typs erwartet wird, bleibt unberücksichtigt. Eine Befassung mit dieser Frage erfolgt hier jedoch nur insoweit, wie dies heutige Typsysteme tatsächlich tun; eine genauere Betrachtung erfolgt dann erst in Kurseinheit 6, Kapitel 54.

Frage: Was versteht man unter einem Subtyp und wie steht er in Beziehung zu einem Supertyp?
Antwort: Ein Subtyp ist ein Typ, dessen Werte oder Objekte überall dort verwendet werden können, wo die Werte des Supertyps, von dem er ein Subtyp ist, erwartet werden. Der Begriff "Subtyp" bezieht sich auf die Rolle eines Typs in der Beziehung zu einem anderen Typ, nämlich der Subtypenbeziehung. Die Gegenrolle in dieser Beziehung wird als Supertyp bezeichnet.

Frage: Welche Implikation hat die Definition von Subtypen in Bezug auf die Zuweisungskompatibilität?
Antwort: Die Definition von Subtypen impliziert Zuweisungskompatibilität. Wenn die Objekte eines Subtyps überall dort verwendet werden können, wo Objekte seines Supertyps erwartet werden, dann können sie auch Werte für Variablen des Supertyps sein. Dies bedeutet, dass ein Subtyp per Definition zuweisungskompatibel mit seinem Supertyp ist.

Frage: Gibt es eine gewisse Zirkularität in der Definition von Subtypen?
Antwort: Ja, es gibt eine gewisse Zirkularität in der Definition von Subtypen. Die Definition selbst basiert auf der Zuweisungskompatibilität zwischen Subtypen und Supertypen. Dies kann den Eindruck erwecken, dass die Beziehung zwischen Subtypen und Supertypen einfacher ist, als sie in der Realität ist. Die eigentliche Frage, welche Bedingungen erfüllt sein müssen, damit ein Objekt eines Subtyps tatsächlich an Stellen verwendet werden darf, an denen ein Objekt eines Supertyps erwartet wird, wird jedoch in dieser Definition nicht näher erläutert.

Frage: Warum könnte die Annotation von Variablen mit dem Supertypen ein Problem darstellen?
Antwort: Die Annotation von Variablen mit dem Supertypen könnte ein Problem darstellen, da dies die Verwendung von Subtypen einschränken würde. Wenn Variablen mit dem Supertypen annotiert sind und nur Werte des Supertyps akzeptieren, könnten keine Objekte des Subtyps in diesen Variablen gespeichert werden, selbst wenn sie die gleiche Struktur oder das gleiche Verhalten aufweisen. Dies würde die Flexibilität des Typsystems einschränken und die Verwendung von Subtypen weniger nützlich machen.